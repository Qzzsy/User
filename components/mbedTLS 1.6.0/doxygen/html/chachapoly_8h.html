<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>D:/GitHub/ARM-software/CMSIS-mbedTLS/Local_Release/include/mbedtls/chachapoly.h File Reference</title>
<title>mbed TLS: D:/GitHub/ARM-software/CMSIS-mbedTLS/Local_Release/include/mbedtls/chachapoly.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="drv.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="printComponentTabs.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylsheetf" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 46px;">
  <td id="projectlogo"><img alt="Logo" src="keilarm.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">mbed TLS
   &#160;<span id="projectnumber">Version 2.17.0</span>
   </div>
   <div id="projectbrief">SSL/TLS Library for the Embedded Space</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<div id="DRVnav" class="tabs1">
    <ul class="tablist">
      <li class="current"><a href="./index.html"><span>mbed TLS</span></a></li>
    </ul>
</div>
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Usage&#160;and&#160;Description</span></a></li>
      <li><a href="modules.html"><span>Reference</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('chachapoly_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">chachapoly.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:structmbedtls__chachapoly__context"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a></td></tr>
<tr class="separator:structmbedtls__chachapoly__context"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa10c236ef79947e0503321c6b91adf6a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#aa10c236ef79947e0503321c6b91adf6a">MBEDTLS_ERR_CHACHAPOLY_BAD_STATE</a>&#160;&#160;&#160;-0x0054</td></tr>
<tr class="memdesc:aa10c236ef79947e0503321c6b91adf6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The requested operation is not permitted in the current state.  <a href="#aa10c236ef79947e0503321c6b91adf6a">More...</a><br/></td></tr>
<tr class="separator:aa10c236ef79947e0503321c6b91adf6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adfcc39d21b02c91dc0429e094e891858"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#adfcc39d21b02c91dc0429e094e891858">MBEDTLS_ERR_CHACHAPOLY_AUTH_FAILED</a>&#160;&#160;&#160;-0x0056</td></tr>
<tr class="memdesc:adfcc39d21b02c91dc0429e094e891858"><td class="mdescLeft">&#160;</td><td class="mdescRight">Authenticated decryption failed: data was not authentic.  <a href="#adfcc39d21b02c91dc0429e094e891858">More...</a><br/></td></tr>
<tr class="separator:adfcc39d21b02c91dc0429e094e891858"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aed9737497f9096f67edc8eab036fb341"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341">mbedtls_chachapoly_mode_t</a> { <br/>
&#160;&#160;<a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341a6897b8bea1e6a49332c85de45070bb6b">MBEDTLS_CHACHAPOLY_ENCRYPT</a>, 
<br/>
&#160;&#160;<a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341ace5d538bce78fdbc0b835578b752d01e">MBEDTLS_CHACHAPOLY_DECRYPT</a>
<br/>
 }</td></tr>
<tr class="separator:aed9737497f9096f67edc8eab036fb341"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a59a82c2427261ad0f163689f9ea327a3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#a59a82c2427261ad0f163689f9ea327a3">mbedtls_chachapoly_init</a> (<a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *ctx)</td></tr>
<tr class="memdesc:a59a82c2427261ad0f163689f9ea327a3"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function initializes the specified ChaCha20-Poly1305 context.  <a href="#a59a82c2427261ad0f163689f9ea327a3">More...</a><br/></td></tr>
<tr class="separator:a59a82c2427261ad0f163689f9ea327a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab52c8fd7aff8b52d6c6be92c19b28e65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#ab52c8fd7aff8b52d6c6be92c19b28e65">mbedtls_chachapoly_free</a> (<a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *ctx)</td></tr>
<tr class="memdesc:ab52c8fd7aff8b52d6c6be92c19b28e65"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function releases and clears the specified ChaCha20-Poly1305 context.  <a href="#ab52c8fd7aff8b52d6c6be92c19b28e65">More...</a><br/></td></tr>
<tr class="separator:ab52c8fd7aff8b52d6c6be92c19b28e65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a943948ae0a8020d327ee3cba84a26b0f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#a943948ae0a8020d327ee3cba84a26b0f">mbedtls_chachapoly_setkey</a> (<a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *ctx, const unsigned char key[32])</td></tr>
<tr class="memdesc:a943948ae0a8020d327ee3cba84a26b0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the ChaCha20-Poly1305 symmetric encryption key.  <a href="#a943948ae0a8020d327ee3cba84a26b0f">More...</a><br/></td></tr>
<tr class="separator:a943948ae0a8020d327ee3cba84a26b0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c1132fa9aa7f156134f7e9c98710444"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#a7c1132fa9aa7f156134f7e9c98710444">mbedtls_chachapoly_starts</a> (<a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *ctx, const unsigned char nonce[12], <a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341">mbedtls_chachapoly_mode_t</a> mode)</td></tr>
<tr class="memdesc:a7c1132fa9aa7f156134f7e9c98710444"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function starts a ChaCha20-Poly1305 encryption or decryption operation.  <a href="#a7c1132fa9aa7f156134f7e9c98710444">More...</a><br/></td></tr>
<tr class="separator:a7c1132fa9aa7f156134f7e9c98710444"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8250d5f2592c57df2e421880dee91e4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#af8250d5f2592c57df2e421880dee91e4">mbedtls_chachapoly_update_aad</a> (<a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *ctx, const unsigned char *aad, size_t aad_len)</td></tr>
<tr class="memdesc:af8250d5f2592c57df2e421880dee91e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function feeds additional data to be authenticated into an ongoing ChaCha20-Poly1305 operation.  <a href="#af8250d5f2592c57df2e421880dee91e4">More...</a><br/></td></tr>
<tr class="separator:af8250d5f2592c57df2e421880dee91e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99f1dbde96f78dd333a3bbfbf75a21be"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#a99f1dbde96f78dd333a3bbfbf75a21be">mbedtls_chachapoly_update</a> (<a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *ctx, size_t len, const unsigned char *input, unsigned char *output)</td></tr>
<tr class="memdesc:a99f1dbde96f78dd333a3bbfbf75a21be"><td class="mdescLeft">&#160;</td><td class="mdescRight">Thus function feeds data to be encrypted or decrypted into an on-going ChaCha20-Poly1305 operation.  <a href="#a99f1dbde96f78dd333a3bbfbf75a21be">More...</a><br/></td></tr>
<tr class="separator:a99f1dbde96f78dd333a3bbfbf75a21be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a18b336e7a9d677f93318851c8da5b6b4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#a18b336e7a9d677f93318851c8da5b6b4">mbedtls_chachapoly_finish</a> (<a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *ctx, unsigned char mac[16])</td></tr>
<tr class="memdesc:a18b336e7a9d677f93318851c8da5b6b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function finished the ChaCha20-Poly1305 operation and generates the MAC (authentication tag).  <a href="#a18b336e7a9d677f93318851c8da5b6b4">More...</a><br/></td></tr>
<tr class="separator:a18b336e7a9d677f93318851c8da5b6b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac03b8f4820e55094fb046610a5acbf7b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#ac03b8f4820e55094fb046610a5acbf7b">mbedtls_chachapoly_encrypt_and_tag</a> (<a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *ctx, size_t length, const unsigned char nonce[12], const unsigned char *aad, size_t aad_len, const unsigned char *input, unsigned char *output, unsigned char tag[16])</td></tr>
<tr class="memdesc:ac03b8f4820e55094fb046610a5acbf7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs a complete ChaCha20-Poly1305 authenticated encryption with the previously-set key.  <a href="#ac03b8f4820e55094fb046610a5acbf7b">More...</a><br/></td></tr>
<tr class="separator:ac03b8f4820e55094fb046610a5acbf7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af11a55f37385ab4a4e4582eff8a2058d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#af11a55f37385ab4a4e4582eff8a2058d">mbedtls_chachapoly_auth_decrypt</a> (<a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *ctx, size_t length, const unsigned char nonce[12], const unsigned char *aad, size_t aad_len, const unsigned char tag[16], const unsigned char *input, unsigned char *output)</td></tr>
<tr class="memdesc:af11a55f37385ab4a4e4582eff8a2058d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs a complete ChaCha20-Poly1305 authenticated decryption with the previously-set key.  <a href="#af11a55f37385ab4a4e4582eff8a2058d">More...</a><br/></td></tr>
<tr class="separator:af11a55f37385ab4a4e4582eff8a2058d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbb54e7c0006e91a3d37758ba1671fe8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="chachapoly_8h.html#acbb54e7c0006e91a3d37758ba1671fe8">mbedtls_chachapoly_self_test</a> (int verbose)</td></tr>
<tr class="memdesc:acbb54e7c0006e91a3d37758ba1671fe8"><td class="mdescLeft">&#160;</td><td class="mdescRight">The ChaCha20-Poly1305 checkup routine.  <a href="#acbb54e7c0006e91a3d37758ba1671fe8">More...</a><br/></td></tr>
<tr class="separator:acbb54e7c0006e91a3d37758ba1671fe8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Description</h2>
<div class="textblock"><p>This file contains the AEAD-ChaCha20-Poly1305 definitions and functions. </p>
<p>ChaCha20-Poly1305 is an algorithm for Authenticated Encryption with Associated Data (AEAD) that can be used to encrypt and authenticate data. It is based on ChaCha20 and Poly1305 by Daniel Bernstein and was standardized in RFC 7539.</p>
<dl class="section author"><dt>Author</dt><dd>Daniel King <a href="#" onclick="location.href='mai'+'lto:'+'dam'+'ak'+'i.g'+'h@'+'gma'+'il'+'.co'+'m'; return false;">damak<span style="display: none;">.nosp@m.</span>i.gh<span style="display: none;">.nosp@m.</span>@gmai<span style="display: none;">.nosp@m.</span>l.co<span style="display: none;">.nosp@m.</span>m</a> </dd></dl>
</div><hr/><h2 class="groupheader">Data Structure Documentation</h2>
<a name="structmbedtls__chachapoly__context" id="structmbedtls__chachapoly__context"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct mbedtls_chachapoly_context</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="textblock"></div><table class="fieldtable">
<tr><th colspan="3">Data Fields</th></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a734596d09a8dcbf6a125c9f290cb5619"></a>uint64_t</td>
<td class="fieldname">
aad_len</td>
<td class="fielddoc">
The length (bytes) of the Additional Authenticated Data. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="ae2922b27870c4848569d50627f823ae8"></a><a class="el" href="chacha20_8h.html#structmbedtls__chacha20__context">mbedtls_chacha20_context</a></td>
<td class="fieldname">
chacha20_ctx</td>
<td class="fielddoc">
The ChaCha20 context. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a82a4b7765577d71065cd65e716e35878"></a>uint64_t</td>
<td class="fieldname">
ciphertext_len</td>
<td class="fielddoc">
The length (bytes) of the ciphertext. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a6640f330154f75d66d9d7538d2604cbb"></a><a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341">mbedtls_chachapoly_mode_t</a></td>
<td class="fieldname">
mode</td>
<td class="fielddoc">
Cipher mode (encrypt or decrypt). </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a7c4e68edbda4bea3ec484d853334d607"></a><a class="el" href="poly1305_8h.html#structmbedtls__poly1305__context">mbedtls_poly1305_context</a></td>
<td class="fieldname">
poly1305_ctx</td>
<td class="fielddoc">
The Poly1305 context. </td></tr>
<tr><td class="fieldtype">
<a class="anchor" id="a89f234133d3efe315836311cbf21c64b"></a>int</td>
<td class="fieldname">
state</td>
<td class="fielddoc">
The current state of the context. </td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="adfcc39d21b02c91dc0429e094e891858"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_CHACHAPOLY_AUTH_FAILED&#160;&#160;&#160;-0x0056</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Authenticated decryption failed: data was not authentic. </p>

</div>
</div>
<a class="anchor" id="aa10c236ef79947e0503321c6b91adf6a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MBEDTLS_ERR_CHACHAPOLY_BAD_STATE&#160;&#160;&#160;-0x0054</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The requested operation is not permitted in the current state. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a class="anchor" id="aed9737497f9096f67edc8eab036fb341"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341">mbedtls_chachapoly_mode_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><em><a class="anchor" id="aed9737497f9096f67edc8eab036fb341a6897b8bea1e6a49332c85de45070bb6b"></a>MBEDTLS_CHACHAPOLY_ENCRYPT</em>&#160;</td><td class="fielddoc">
<p>The mode value for performing encryption. </p>
</td></tr>
<tr><td class="fieldname"><em><a class="anchor" id="aed9737497f9096f67edc8eab036fb341ace5d538bce78fdbc0b835578b752d01e"></a>MBEDTLS_CHACHAPOLY_DECRYPT</em>&#160;</td><td class="fielddoc">
<p>The mode value for performing decryption. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="af11a55f37385ab4a4e4582eff8a2058d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_auth_decrypt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>nonce</em>[12], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>aad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>aad_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>tag</em>[16], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs a complete ChaCha20-Poly1305 authenticated decryption with the previously-set key. </p>
<dl class="section note"><dt>Note</dt><dd>Before using this function, you must set the key with <code><a class="el" href="chachapoly_8h.html#a943948ae0a8020d327ee3cba84a26b0f" title="This function sets the ChaCha20-Poly1305 symmetric encryption key. ">mbedtls_chachapoly_setkey()</a></code>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChaCha20-Poly1305 context to use (holds the key). </td></tr>
    <tr><td class="paramname">length</td><td>The length (in Bytes) of the data to decrypt. </td></tr>
    <tr><td class="paramname">nonce</td><td>The <code>96</code> Bit (<code>12</code> bytes) nonce/IV to use. </td></tr>
    <tr><td class="paramname">aad</td><td>The buffer containing the additional authenticated data (AAD). This pointer can be <code>NULL</code> if <code>aad_len == 0</code>. </td></tr>
    <tr><td class="paramname">aad_len</td><td>The length (in bytes) of the AAD data to process. </td></tr>
    <tr><td class="paramname">tag</td><td>The buffer holding the authentication tag. This must be a readable buffer of length <code>16</code> Bytes. </td></tr>
    <tr><td class="paramname">input</td><td>The buffer containing the data to decrypt. This pointer can be <code>NULL</code> if <code>ilen == 0</code>. </td></tr>
    <tr><td class="paramname">output</td><td>The buffer to where the decrypted data is written. This pointer can be <code>NULL</code> if <code>ilen == 0</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="chachapoly_8h.html#adfcc39d21b02c91dc0429e094e891858" title="Authenticated decryption failed: data was not authentic. ">MBEDTLS_ERR_CHACHAPOLY_AUTH_FAILED</a> if the data was not authentic. </dd>
<dd>
Another negative error code on other kinds of failure. </dd></dl>

</div>
</div>
<a class="anchor" id="ac03b8f4820e55094fb046610a5acbf7b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_encrypt_and_tag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>nonce</em>[12], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>aad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>aad_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>tag</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs a complete ChaCha20-Poly1305 authenticated encryption with the previously-set key. </p>
<dl class="section note"><dt>Note</dt><dd>Before using this function, you must set the key with <code><a class="el" href="chachapoly_8h.html#a943948ae0a8020d327ee3cba84a26b0f" title="This function sets the ChaCha20-Poly1305 symmetric encryption key. ">mbedtls_chachapoly_setkey()</a></code>.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>You must never use the same nonce twice with the same key. This would void any confidentiality and authenticity guarantees for the messages encrypted with the same nonce and key.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChaCha20-Poly1305 context to use (holds the key). This must be initialized. </td></tr>
    <tr><td class="paramname">length</td><td>The length (in bytes) of the data to encrypt or decrypt. </td></tr>
    <tr><td class="paramname">nonce</td><td>The 96-bit (12 bytes) nonce/IV to use. </td></tr>
    <tr><td class="paramname">aad</td><td>The buffer containing the additional authenticated data (AAD). This pointer can be <code>NULL</code> if <code>aad_len == 0</code>. </td></tr>
    <tr><td class="paramname">aad_len</td><td>The length (in bytes) of the AAD data to process. </td></tr>
    <tr><td class="paramname">input</td><td>The buffer containing the data to encrypt or decrypt. This pointer can be <code>NULL</code> if <code>ilen == 0</code>. </td></tr>
    <tr><td class="paramname">output</td><td>The buffer to where the encrypted or decrypted data is written. This pointer can be <code>NULL</code> if <code>ilen == 0</code>. </td></tr>
    <tr><td class="paramname">tag</td><td>The buffer to where the computed 128-bit (16 bytes) MAC is written. This must not be <code>NULL</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
A negative error code on failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a18b336e7a9d677f93318851c8da5b6b4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>mac</em>[16]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function finished the ChaCha20-Poly1305 operation and generates the MAC (authentication tag). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChaCha20-Poly1305 context to use. This must be initialized. </td></tr>
    <tr><td class="paramname">mac</td><td>The buffer to where the 128-bit (16 bytes) MAC is written.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>Decryption with the piecewise API is discouraged, see the warning on <code><a class="el" href="chachapoly_8h.html#a59a82c2427261ad0f163689f9ea327a3" title="This function initializes the specified ChaCha20-Poly1305 context. ">mbedtls_chachapoly_init()</a></code>.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="chachapoly_8h.html#aa10c236ef79947e0503321c6b91adf6a" title="The requested operation is not permitted in the current state. ">MBEDTLS_ERR_CHACHAPOLY_BAD_STATE</a> if the operation has not been started or has been finished. </dd>
<dd>
Another negative error code on other kinds of failure. </dd></dl>

</div>
</div>
<a class="anchor" id="ab52c8fd7aff8b52d6c6be92c19b28e65"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_chachapoly_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function releases and clears the specified ChaCha20-Poly1305 context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChachaPoly context to clear. This may be <code>NULL</code>, in which case this function is a no-op. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a59a82c2427261ad0f163689f9ea327a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mbedtls_chachapoly_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function initializes the specified ChaCha20-Poly1305 context. </p>
<p>It must be the first API called before using the context. It must be followed by a call to <code><a class="el" href="chachapoly_8h.html#a943948ae0a8020d327ee3cba84a26b0f" title="This function sets the ChaCha20-Poly1305 symmetric encryption key. ">mbedtls_chachapoly_setkey()</a></code> before any operation can be done, and to <code><a class="el" href="chachapoly_8h.html#ab52c8fd7aff8b52d6c6be92c19b28e65" title="This function releases and clears the specified ChaCha20-Poly1305 context. ">mbedtls_chachapoly_free()</a></code> once all operations with that context have been finished.</p>
<p>In order to encrypt or decrypt full messages at once, for each message you should make a single call to <code>mbedtls_chachapoly_crypt_and_tag()</code> or <code><a class="el" href="chachapoly_8h.html#af11a55f37385ab4a4e4582eff8a2058d" title="This function performs a complete ChaCha20-Poly1305 authenticated decryption with the previously-set ...">mbedtls_chachapoly_auth_decrypt()</a></code>.</p>
<p>In order to encrypt messages piecewise, for each message you should make a call to <code><a class="el" href="chachapoly_8h.html#a7c1132fa9aa7f156134f7e9c98710444" title="This function starts a ChaCha20-Poly1305 encryption or decryption operation. ">mbedtls_chachapoly_starts()</a></code>, then 0 or more calls to <code><a class="el" href="chachapoly_8h.html#af8250d5f2592c57df2e421880dee91e4" title="This function feeds additional data to be authenticated into an ongoing ChaCha20-Poly1305 operation...">mbedtls_chachapoly_update_aad()</a></code>, then 0 or more calls to <code><a class="el" href="chachapoly_8h.html#a99f1dbde96f78dd333a3bbfbf75a21be" title="Thus function feeds data to be encrypted or decrypted into an on-going ChaCha20-Poly1305 operation...">mbedtls_chachapoly_update()</a></code>, then one call to <code><a class="el" href="chachapoly_8h.html#a18b336e7a9d677f93318851c8da5b6b4" title="This function finished the ChaCha20-Poly1305 operation and generates the MAC (authentication tag)...">mbedtls_chachapoly_finish()</a></code>.</p>
<dl class="section warning"><dt>Warning</dt><dd>Decryption with the piecewise API is discouraged! Always use <code><a class="el" href="chachapoly_8h.html#af11a55f37385ab4a4e4582eff8a2058d" title="This function performs a complete ChaCha20-Poly1305 authenticated decryption with the previously-set ...">mbedtls_chachapoly_auth_decrypt()</a></code> when possible!</dd></dl>
<p>If however this is not possible because the data is too large to fit in memory, you need to:</p>
<ul>
<li>call <code><a class="el" href="chachapoly_8h.html#a7c1132fa9aa7f156134f7e9c98710444" title="This function starts a ChaCha20-Poly1305 encryption or decryption operation. ">mbedtls_chachapoly_starts()</a></code> and (if needed) <code><a class="el" href="chachapoly_8h.html#af8250d5f2592c57df2e421880dee91e4" title="This function feeds additional data to be authenticated into an ongoing ChaCha20-Poly1305 operation...">mbedtls_chachapoly_update_aad()</a></code> as above,</li>
<li>call <code><a class="el" href="chachapoly_8h.html#a99f1dbde96f78dd333a3bbfbf75a21be" title="Thus function feeds data to be encrypted or decrypted into an on-going ChaCha20-Poly1305 operation...">mbedtls_chachapoly_update()</a></code> multiple times and ensure its output (the plaintext) is NOT used in any other way than placing it in temporary storage at this point,</li>
<li>call <code><a class="el" href="chachapoly_8h.html#a18b336e7a9d677f93318851c8da5b6b4" title="This function finished the ChaCha20-Poly1305 operation and generates the MAC (authentication tag)...">mbedtls_chachapoly_finish()</a></code> to compute the authentication tag and compared it in constant time to the tag received with the ciphertext.</li>
</ul>
<p>If the tags are not equal, you must immediately discard all previous outputs of <code><a class="el" href="chachapoly_8h.html#a99f1dbde96f78dd333a3bbfbf75a21be" title="Thus function feeds data to be encrypted or decrypted into an on-going ChaCha20-Poly1305 operation...">mbedtls_chachapoly_update()</a></code>, otherwise you can now safely use the plaintext.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChachaPoly context to initialize. Must not be <code>NULL</code>. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="acbb54e7c0006e91a3d37758ba1671fe8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_self_test </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verbose</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The ChaCha20-Poly1305 checkup routine. </p>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<code>1</code> on failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a943948ae0a8020d327ee3cba84a26b0f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_setkey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>key</em>[32]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the ChaCha20-Poly1305 symmetric encryption key. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChaCha20-Poly1305 context to which the key should be bound. This must be initialized. </td></tr>
    <tr><td class="paramname">key</td><td>The <code>256</code> Bit (<code>32</code> Bytes) key.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
A negative error code on failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a7c1132fa9aa7f156134f7e9c98710444"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_starts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char&#160;</td>
          <td class="paramname"><em>nonce</em>[12], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341">mbedtls_chachapoly_mode_t</a>&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function starts a ChaCha20-Poly1305 encryption or decryption operation. </p>
<dl class="section warning"><dt>Warning</dt><dd>You must never use the same nonce twice with the same key. This would void any confidentiality and authenticity guarantees for the messages encrypted with the same nonce and key.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If the context is being used for AAD only (no data to encrypt or decrypt) then <code>mode</code> can be set to any value.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Decryption with the piecewise API is discouraged, see the warning on <code><a class="el" href="chachapoly_8h.html#a59a82c2427261ad0f163689f9ea327a3" title="This function initializes the specified ChaCha20-Poly1305 context. ">mbedtls_chachapoly_init()</a></code>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChaCha20-Poly1305 context. This must be initialized and bound to a key. </td></tr>
    <tr><td class="paramname">nonce</td><td>The nonce/IV to use for the message. This must be a redable buffer of length <code>12</code> Bytes. </td></tr>
    <tr><td class="paramname">mode</td><td>The operation to perform: <a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341a6897b8bea1e6a49332c85de45070bb6b" title="The mode value for performing encryption. ">MBEDTLS_CHACHAPOLY_ENCRYPT</a> or <a class="el" href="chachapoly_8h.html#aed9737497f9096f67edc8eab036fb341ace5d538bce78fdbc0b835578b752d01e" title="The mode value for performing decryption. ">MBEDTLS_CHACHAPOLY_DECRYPT</a> (discouraged, see warning).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
A negative error code on failure. </dd></dl>

</div>
</div>
<a class="anchor" id="a99f1dbde96f78dd333a3bbfbf75a21be"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Thus function feeds data to be encrypted or decrypted into an on-going ChaCha20-Poly1305 operation. </p>
<p>The direction (encryption or decryption) depends on the mode that was given when calling <code><a class="el" href="chachapoly_8h.html#a7c1132fa9aa7f156134f7e9c98710444" title="This function starts a ChaCha20-Poly1305 encryption or decryption operation. ">mbedtls_chachapoly_starts()</a></code>.</p>
<p>You may call this function multiple times to process an arbitrary amount of data. It is permitted to call this function 0 times, if no data is to be encrypted or decrypted.</p>
<dl class="section warning"><dt>Warning</dt><dd>Decryption with the piecewise API is discouraged, see the warning on <code><a class="el" href="chachapoly_8h.html#a59a82c2427261ad0f163689f9ea327a3" title="This function initializes the specified ChaCha20-Poly1305 context. ">mbedtls_chachapoly_init()</a></code>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChaCha20-Poly1305 context to use. This must be initialized. </td></tr>
    <tr><td class="paramname">len</td><td>The length (in bytes) of the data to encrypt or decrypt. </td></tr>
    <tr><td class="paramname">input</td><td>The buffer containing the data to encrypt or decrypt. This pointer can be <code>NULL</code> if <code>len == 0</code>. </td></tr>
    <tr><td class="paramname">output</td><td>The buffer to where the encrypted or decrypted data is written. This must be able to hold <code>len</code> bytes. This pointer can be <code>NULL</code> if <code>len == 0</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="chachapoly_8h.html#aa10c236ef79947e0503321c6b91adf6a" title="The requested operation is not permitted in the current state. ">MBEDTLS_ERR_CHACHAPOLY_BAD_STATE</a> if the operation has not been started or has been finished. </dd>
<dd>
Another negative error code on other kinds of failure. </dd></dl>

</div>
</div>
<a class="anchor" id="af8250d5f2592c57df2e421880dee91e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int mbedtls_chachapoly_update_aad </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="chachapoly_8h.html#structmbedtls__chachapoly__context">mbedtls_chachapoly_context</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>aad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>aad_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function feeds additional data to be authenticated into an ongoing ChaCha20-Poly1305 operation. </p>
<p>The Additional Authenticated Data (AAD), also called Associated Data (AD) is only authenticated but not encrypted nor included in the encrypted output. It is usually transmitted separately from the ciphertext or computed locally by each party.</p>
<dl class="section note"><dt>Note</dt><dd>This function is called before data is encrypted/decrypted. I.e. call this function to process the AAD before calling <code><a class="el" href="chachapoly_8h.html#a99f1dbde96f78dd333a3bbfbf75a21be" title="Thus function feeds data to be encrypted or decrypted into an on-going ChaCha20-Poly1305 operation...">mbedtls_chachapoly_update()</a></code>.</dd></dl>
<p>You may call this function multiple times to process an arbitrary amount of AAD. It is permitted to call this function 0 times, if no AAD is used.</p>
<p>This function cannot be called any more if data has been processed by <code><a class="el" href="chachapoly_8h.html#a99f1dbde96f78dd333a3bbfbf75a21be" title="Thus function feeds data to be encrypted or decrypted into an on-going ChaCha20-Poly1305 operation...">mbedtls_chachapoly_update()</a></code>, or if the context has been finished.</p>
<dl class="section warning"><dt>Warning</dt><dd>Decryption with the piecewise API is discouraged, see the warning on <code><a class="el" href="chachapoly_8h.html#a59a82c2427261ad0f163689f9ea327a3" title="This function initializes the specified ChaCha20-Poly1305 context. ">mbedtls_chachapoly_init()</a></code>.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ctx</td><td>The ChaCha20-Poly1305 context. This must be initialized and bound to a key. </td></tr>
    <tr><td class="paramname">aad_len</td><td>The length in Bytes of the AAD. The length has no restrictions. </td></tr>
    <tr><td class="paramname">aad</td><td>Buffer containing the AAD. This pointer can be <code>NULL</code> if <code>aad_len == 0</code>.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>0</code> on success. </dd>
<dd>
<a class="el" href="poly1305_8h.html#a2d22050169c640e1622e46202e70ab1d" title="Invalid input parameter(s). ">MBEDTLS_ERR_POLY1305_BAD_INPUT_DATA</a> if <code>ctx</code> or <code>aad</code> are NULL. </dd>
<dd>
<a class="el" href="chachapoly_8h.html#aa10c236ef79947e0503321c6b91adf6a" title="The requested operation is not permitted in the current state. ">MBEDTLS_ERR_CHACHAPOLY_BAD_STATE</a> if the operations has not been started or has been finished, or if the AAD has been finished. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_b4d146e9a6d8dd56ed4afb2480a97fd3.html">mbedtls</a></li><li class="navelem"><a class="el" href="chachapoly_8h.html">chachapoly.h</a></li>
    <li class="footer">Generated on Tue Apr 2 2019 14:05:54 for mbed TLS by ARM Ltd. All rights reserved.
	<!--
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 
	-->
	</li>
  </ul>
</div>
</body>
</html>
